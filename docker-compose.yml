# dev yaml, rename later to docker-compose.dev.yml to distinct from prod
# diff is bind volume on flask app, debug enabled (hot reload) and unsafe neo4j pwd 
services:
  webapp:
    build:
      context: .
    container_name: flask-app
    ports:
      - "5000:5000"
    volumes:
      - .:/flask-app   
    depends_on:
      neo4j:
        condition: service_healthy
    environment:
      FLASK_ENV: development # Enable development mode for Flask
    restart:
      always

  neo4j:
    image: neo4j:5.24-community-bullseye
    container_name: neo4j-db
    volumes:
      - neo4j_data:/data  
      - neo4j_logs:/logs  
    ports:
      - "7474:7474"   # web interface
      - "7687:7687"   # Bolt protocol (used by drivers)
    environment:
      - NEO4J_AUTH=neo4j/test1234 # not secure
    restart:
      always
    healthcheck:
      test: wget http://localhost:7687 || exit 1
      interval: 3s
      timeout: 10s
      retries: 20
      start_period: 3s


volumes:
  neo4j_data:
  neo4j_logs: